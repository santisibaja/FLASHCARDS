<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fichas de Estudio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 15px;
            background: linear-gradient(135deg, #1a5276 0%, #2980b9 100%);
            min-height: 100vh;
            max-width: 100%;
            margin: 0 auto;
            color: #333;
            display: flex;
            flex-direction: column;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            color: white;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .app-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow: hidden;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px;
            background: #e9ecef;
            border: none;
            border-right: 1px solid #ddd;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .tab-btn:last-child {
            border-right: none;
        }
        
        .tab-btn.active {
            background: #2980b9;
            color: white;
        }
        
        .settings {
            padding: 15px;
            background: #f8f9fa;
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid #eee;
        }
        
        .stats {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .counter {
            background: #e9ecef;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .progress-container {
            flex-grow: 1;
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 0 15px;
        }
        
        .progress-bar {
            height: 100%;
            background: #2980b9;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .controls-top {
            display: flex;
            gap: 10px;
        }
        
        button {
            background: #2980b9;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        
        button:active {
            transform: scale(0.96);
            background: #1a5276;
        }
        
        #shuffle-btn {
            background: #e67e22;
        }
        
        #shuffle-btn:active {
            background: #d35400;
        }
        
        .flashcard-container {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .flashcard {
            background: white;
            border-radius: 16px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 30px;
            cursor: pointer;
            height: 300px;
            width: 100%;
            max-width: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            transform-style: preserve-3d;
            perspective: 1000px;
            -webkit-user-select: none;
            user-select: none;
            transition: transform 0.6s;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .flashcard.flipped {
            transform: rotateY(180deg);
        }
        
        .flashcard-content {
            position: absolute;
            width: calc(100% - 60px);
            height: calc(100% - 60px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backface-visibility: hidden;
            overflow-y: auto;
        }
        
        .flashcard-front {
            background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
            color: white;
            border-radius: 12px;
        }
        
        .flashcard-back {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border-radius: 12px;
            transform: rotateY(180deg);
        }
        
        .question {
            font-weight: bold;
            font-size: 1.4rem;
            line-height: 1.4;
        }
        
        .answer {
            font-size: 1.2rem;
            line-height: 1.4;
            text-align: left;
            padding: 0 15px;
        }
        
        .answer ul {
            margin-top: 10px;
            padding-left: 20px;
        }
        
        .answer li {
            margin-bottom: 8px;
        }
        
        .hint {
            position: absolute;
            bottom: 15px;
            color: rgba(255,255,255,0.7);
            font-size: 0.9rem;
        }
        
        .controls-bottom {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            gap: 15px;
            background: #f8f9fa;
            border-top: 1px solid #eee;
        }
        
        .nav-btn {
            flex: 1;
            padding: 15px;
            font-size: 1rem;
        }
        
        .footer {
            text-align: center;
            color: rgba(255,255,255,0.8);
            padding: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .creator {
            font-weight: bold;
            color: white;
            text-decoration: none;
        }
        
        .creator:hover {
            text-decoration: underline;
        }
        
        .swipe-instruction {
            text-align: center;
            color: #6c757d;
            margin-top: 10px;
            font-size: 0.9rem;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .flip-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            color: rgba(255,255,255,0.7);
            font-size: 1.2rem;
        }
        
        /* Estilos para la sección de preguntas */
        .question-container {
            padding: 20px;
            display: none;
            flex-direction: column;
            height: 100%;
        }
        
        .question-container.active {
            display: flex;
        }
        
        .question-statement {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 20px;
            flex-grow: 1;
        }
        
        .option-btn {
            background: white;
            border: 2px solid #e2e2e2;
            border-radius: 10px;
            padding: 15px;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            color: black; /* Texto negro para mejor contraste */
        }
        
        .option-btn:hover {
            border-color: #3498db;
        }
        
        .option-btn.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }
        
        .option-btn.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        
        .option-btn.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
        }
        
        .quiz-controls {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            flex-shrink: 0;
        }
        
        .quiz-nav-btn {
            flex: 1;
        }
        
        .quiz-stats {
            background: #e9ecef;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .spaced-repetition-info {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        @media (max-width: 600px) {
            .question {
                font-size: 1.2rem;
            }
            
            .answer {
                font-size: 1.1rem;
            }
            
            .flashcard {
                height: 250px;
                padding: 20px;
            }
            
            button {
                padding: 8px 12px;
            }
            
            .settings {
                flex-direction: column;
                gap: 10px;
            }
            
            .controls-top {
                justify-content: center;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .question-statement {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-book"></i> Fichas de Estudio</h1>
        <div class="subtitle">Formas de Tratamiento y La Metamorfosis</div>
    </header>
    
    <div class="app-container">
        <div class="tabs">
            <button class="tab-btn active" data-tab="formas">Formas de Tratamiento</button>
            <button class="tab-btn" data-tab="metamorfosis">La Metamorfosis</button>
            <button class="tab-btn" data-tab="preguntas">Preguntas Kahoot</button>
        </div>
        
        <div class="settings">
            <div class="stats">
                <div class="counter">Tarjeta <span id="current-card">1</span> de <span id="total-cards">15</span></div>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
            </div>
            
            <div class="controls-top">
                <button id="shuffle-btn">
                    <i class="fas fa-random"></i> Mezclar
                </button>
            </div>
        </div>
        
        <!-- Sección de fichas -->
        <div class="flashcard-container" id="flashcard-section">
            <div class="flashcard" id="current-flashcard">
                <div class="flashcard-content flashcard-front">
                    <div class="question">Cargando preguntas...</div>
                    <div class="hint">Toca la tarjeta para ver la respuesta</div>
                    <div class="flip-icon"><i class="fas fa-sync-alt"></i></div>
                </div>
                <div class="flashcard-content flashcard-back">
                    <div class="answer">Cargando respuestas...</div>
                    <div class="hint">Toca la tarjeta para volver a la pregunta</div>
                    <div class="flip-icon"><i class="fas fa-sync-alt"></i></div>
                </div>
            </div>
        </div>
        
        <div class="swipe-instruction">
            <span><i class="fas fa-arrow-left"></i> Desliza para anterior</span>
            <span>Desliza para siguiente <i class="fas fa-arrow-right"></i></span>
        </div>
        
        <div class="controls-bottom">
            <button id="prev-btn" class="nav-btn">
                <i class="fas fa-arrow-left"></i> Anterior
            </button>
            <button id="next-btn" class="nav-btn">
                Siguiente <i class="fas fa-arrow-right"></i>
            </button>
        </div>
        
        <!-- Sección de preguntas Kahoot -->
        <div class="question-container" id="question-section">
            <div class="question-statement" id="question-statement">Cargando pregunta...</div>
            <div class="options" id="options-container">
                <!-- Las opciones se generarán dinámicamente -->
            </div>
            <div class="feedback" id="feedback"></div>
            
            <div class="spaced-repetition-info" id="repetition-info">
                <i class="fas fa-sync-alt"></i> Esta pregunta se repite porque la fallaste anteriormente. Sigue practicando hasta dominarla.
            </div>
            
            <div class="quiz-controls">
                <button id="quiz-prev-btn" class="quiz-nav-btn">
                    <i class="fas fa-arrow-left"></i> Anterior
                </button>
                <div class="quiz-stats">Pregunta <span id="current-question">1</span> de <span id="total-questions">15</span></div>
                <button id="quiz-next-btn" class="quiz-nav-btn">
                    Siguiente <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>
    
    <div class="footer">
        Creado por <a href="#" class="creator">Santiago Sibaja</a> | Toca las tarjetas para voltearlas
    </div>
    
    <script>
        // Datos para las fichas de Formas de Tratamiento (15 fichas)
        const formasDeTratamiento = [
            {
                question: "¿Qué son las formas de tratamiento?",
                answer: "Son los usos que los hablantes hacen de la segunda persona gramatical para referirse a esta en forma respetuosa o en un tono de confianza. En español existen tres: voseo, ustedeo y tuteo."
            },
            {
                question: "Explica el voseo verbal",
                answer: "Se presenta a través de las desinencias verbales, generalmente en el presente del modo indicativo, con tilde en la última sílaba (posición aguda). Ej: '¿Querés ir al cine mañana?'"
            },
            {
                question: "Explica el voseo pronominal",
                answer: "Utiliza los pronombres 'vos' y 'te', y los adjetivos posesivos 'tu(s)', 'tuyo(s)', 'tuya(s)'. Ej: 'Me parece que Luisa venía con vos, ¿no es cierto?'"
            },
            {
                question: "¿Qué es el tuteo?",
                answer: "Se emplea en contextos informales con parientes, amigos o personas de confianza. Ej: '¿Quieres pizza o pollo?'"
            },
            {
                question: "Explica el tuteo pronominal",
                answer: "Utiliza los pronombres 'tú', 'te', 'ti', 'contigo' y los adjetivos posesivos 'tu(s)', 'tuyo(s)', 'tuya(s)'. Ej: '¿Puedo ir contigo al supermercado?'"
            },
            {
                question: "¿Qué es el ustedeo?",
                answer: "Surgió como forma de tratamiento de respeto y cortesía. Evolucionó de 'vuestra merced' a 'usted'. Se usa en contextos formales."
            },
            {
                question: "Explica el ustedeo verbal",
                answer: "Se presenta a través de las desinencias verbales. Ej: 'Disculpe, señora, ¿cómo llego a la parada de autobuses?'"
            },
            {
                question: "Explica el ustedeo pronominal",
                answer: "Utiliza los pronombres 'usted', 'se', 'la(s)', 'le(s)', 'lo(s)' y los adjetivos posesivos 'su(s)', 'suyo(s)', 'suya(s)'. Ej: '¿Le quedó bien el abrigo?'"
            },
            {
                question: "¿Cuál es un error común en el uso de formas de tratamiento?",
                answer: "Mezclar las formas en un mismo contexto. Ej incorrecto: 'Luis, ¿vos puedes ayudarme?' (mezcla 'vos' con verbo tuteo 'puedes'). Lo correcto sería 'Luis, ¿vos podés ayudarme?' o 'Luis, ¿tú puedes ayudarme?'"
            },
            {
                question: "¿Cómo distinguir tuteo y voseo?",
                answer: "Por las desinencias verbales y el acento gráfico. Ej: <br>Tú: Caminas<br>Vos: Caminás<br>Usted: Camina"
            },
            {
                question: "¿Dónde es más común el voseo?",
                answer: "En países como Argentina, Uruguay, Paraguay, Costa Rica, Nicaragua, y en algunas regiones de Colombia, Venezuela y Chile. En España prácticamente no se usa."
            },
            {
                question: "¿Qué diferencia hay entre 'tú' y 'usted'?",
                answer: "'Tú' se usa en contextos informales y de confianza, mientras que 'usted' se usa en situaciones formales, con personas mayores o para mostrar respeto."
            },
            {
                question: "¿Cómo se conjuga el verbo 'ser' en voseo?",
                answer: "Presente de indicativo: vos sos<br>Ej: 'Vos sos mi mejor amigo'"
            },
            {
                question: "¿Qué es el 'vosotros'?",
                answer: "Es la forma plural del 'tú' que se usa principalmente en España. Ej: 'Vosotros sois estudiantes'. En América Latina se reemplaza por 'ustedes'."
            },
            {
                question: "Ejemplo de ustedeo en una frase completa",
                answer: "'Señor, ¿le gustaría que le ayudara con su equipaje? Usted parece cansado.'<br>Aquí se usan los pronombres 'le' y 'usted', y la conjugación verbal 'gustaría' y 'parece' propias del ustedeo."
            }
        ];

        // Datos para las fichas de La Metamorfosis (15 fichas)
        const metamorfosisCards = [
            {
                question: "¿Quién es el autor de 'La metamorfosis'?",
                answer: "Franz Kafka (1883-1924), escritor checo en lengua alemana. Nació en una familia de comerciantes judíos y trabajó en una compañía de seguros en Praga."
            },
            {
                question: "¿En qué movimiento literario se inscribe la obra?",
                answer: "Vanguardismo: Divide en -Expresionismo: angustia de la vida humana. -Existencialismo libertad y elección individual y surrealismo: Sobre o más alla de lo real."
            },
            {
                question: "Describe la transformación de Gregorio Samsa",
                answer: "Gregorio despierta convertido en un insecto monstruoso. Su conciencia humana va perdiendo fuerza gradualmente hasta convertirse en conciencia animal. La obra comienza con la metamorfosis ya consumada."
            },
            {
                question: "¿Cuáles son los personajes principales?",
                answer: "<ul><li>Gregorio Samsa: Protagonista convertido en insecto</li><li>Grete: Hermana que sufre una transformación en su actitud</li><li>Señor Samsa: Padre autoritario y violento</li><li>Señora Samsa: Madre subordinada y sentimental</li><li>Sirvienta: Sarcástica e inhumana</li><li>Los tres huéspedes: Representan la autoridad social</li></ul>"
            },
            {
                question: "Explica los temas principales de la obra",
                answer: "<ul><li>Autoritarismo: Sometimiento y subordinación</li><li>Depresión: Consecuencias de vivir bajo régimen opresivo</li><li>Deshumanización: Pérdida de sensibilidad hacia otros</li><li>Muerte como solución: Único escape al sufrimiento</li><li>Mediocridad de la vida cotidiana: Rutina sin esperanza</li></ul>"
            },
            {
                question: "¿Qué elementos hay y que simbolizan?",
                answer: "<ul><li>Gregorio: La 'animalización' del ser humano</li><li>El violín: Lo humano, el arte, la belleza</li><li>La ventana: Incapacidad de comunicación con el mundo exterior</li><li>La manzana: Odio, rechazo, violencia familiar</li><li>La casa: Sociedad destruida, sin fe ni esperanza</li></ul>"
            },
            {
                question: "Describe la estructura de la obra",
                answer: "Dividida en cuatro partes sin nombre (para igualdad):<ol><li>Autoridad laboral (enfrentamiento con el jefe)</li><li>Autoridad fraternal (Grete cuida a Gregorio)</li><li>Autoridad paternal (arrebato del padre)</li><li>Autoridad social (los tres huéspedes)</li></ol>"
            },
            {
                question: "¿Qué tipo de sociedad se presenta?",
                answer: "Una sociedad capitalista, utilitarista y deshumanizante donde el valor del individuo se basa en su productividad económica. Gregorio es apreciado mientras puede trabajar, pero cuando se transforma, su familia lo aísla y rechaza."
            },
            {
                question: "¿Cómo reacciona la familia ante la muerte de Gregorio?",
                answer: "Su muerte se presenta como un alivio. La familia lo abandona a su suerte y su muerte les permite celebrar y buscar nuevas opciones de vida. Representa la liberación de una vida de sufrimiento."
            },
            {
                question: "Relación entre Kafka y Gregorio Samsa",
                answer: "Gregorio es un reflejo de Kafka y su familia. Ambos carecen de relaciones significativas con sus allegados. La relación deprimente de Kafka con su padre se refleja en el repudio que sufre Gregorio por parte de su familia."
            },
            {
                question: "¿Qué representa el trabajo de viajante de Gregorio?",
                answer: "La alienación laboral y la esclavitud del sistema capitalista. Gregorio odia su trabajo pero se siente obligado a mantenerlo para pagar las deudas de su familia."
            },
            {
                question: "¿Cómo evoluciona el personaje de Grete?",
                answer: "Al inicio se muestra compasiva con Gregorio, pero gradualmente se vuelve indiferente y finalmente lo rechaza. Su transformación simboliza cómo la sociedad corrompe la compasión humana."
            },
            {
                question: "¿Qué papel juega la comida en la obra?",
                answer: "Al inicio, la familia intenta alimentar a Gregorio con comida humana, luego le dan restos y finalmente lo olvidan. Este deterioro refleja la pérdida de humanidad y la degradación de Gregorio."
            },
            {
                question: "Explica el significado del título",
                answer: "La 'metamorfosis' no solo se refiere al cambio físico de Gregorio, sino también a las transformaciones psicológicas de los personajes y la transformación de la familia tras el cambio de Gregorio."
            },
            {
                question: "¿Qué simboliza la manzana que el padre lanza a Gregorio?",
                answer: "Representa el rechazo violento de la familia y la agresión física. La manzana queda incrustada en el cuerpo de Gregorio como símbolo de la culpa que siente y del dolor familiar."
            }
        ];

        // Preguntas de selección única para el apartado Kahoot (15 preguntas)
        const kahootQuestions = [
            // Preguntas sobre Formas de Tratamiento (10)
            {
                question: "¿Cuál es un ejemplo correcto de voseo verbal?",
                options: [
                    "¿Vos puedes ayudarme?",
                    "¿Vos podés ayudarme?",
                    "¿Tú podés ayudarme?",
                    "¿Usted puede ayudarme?"
                ],
                correctIndex: 1
            },
            {
                question: "En el ustedeo, ¿qué pronombres se utilizan?",
                options: [
                    "tú, te, ti, contigo",
                    "vos, te, tu, tuyo",
                    "usted, se, le, lo",
                    "tú, vos, usted"
                ],
                correctIndex: 2
            },
            {
                question: "¿Qué forma de tratamiento se usa en contextos informales con amigos o familiares?",
                options: [
                    "Ustedeo",
                    "Voseo",
                    "Tuteo",
                    "Todas las anteriores"
                ],
                correctIndex: 2
            },
            {
                question: "¿Cuál es un error común en el uso de formas de tratamiento?",
                options: [
                    "Usar 'vos' con conjugación verbal de 'tú'",
                    "Usar 'usted' en contextos formales",
                    "Usar 'tú' con amigos",
                    "No usar tilde en el voseo"
                ],
                correctIndex: 0
            },
            {
                question: "¿Cómo se dice 'caminas' en voseo?",
                options: [
                    "Caminas",
                    "Caminás",
                    "Camina",
                    "Caminan"
                ],
                correctIndex: 1
            },
            {
                question: "¿Cuál es la forma correcta del verbo 'tener' en voseo?",
                options: [
                    "Vos tienes",
                    "Vos tenés",
                    "Vos tiene",
                    "Vos tener"
                ],
                correctIndex: 1
            },
            {
                question: "¿En qué país NO se usa comúnmente el voseo?",
                options: [
                    "Argentina",
                    "España",
                    "Costa Rica",
                    "Uruguay"
                ],
                correctIndex: 1
            },
            {
                question: "¿Cómo se conjuga el verbo 'ir' en voseo?",
                options: [
                    "Vos vas",
                    "Vos vás",
                    "Vos ís",
                    "Vos íes"
                ],
                correctIndex: 0
            },
            {
                question: "¿Qué pronombre usarías con un desconocido en un contexto formal?",
                options: [
                    "Tú",
                    "Vos",
                    "Usted",
                    "Vosotros"
                ],
                correctIndex: 2
            },
            {
                question: "¿Cuál es la forma plural de 'tú' en España?",
                options: [
                    "Ustedes",
                    "Vosotros",
                    "Vosotras",
                    "Usted"
                ],
                correctIndex: 1
            },
            
            // Preguntas sobre La Metamorfosis (5)
            {
                question: "¿En qué movimiento literario se inscribe principalmente 'La metamorfosis'?",
                options: [
                    "Romanticismo",
                    "Realismo",
                    "Expresionismo",
                    "Modernismo"
                ],
                correctIndex: 2
            },
            {
                question: "¿Qué simboliza el violín en la obra?",
                options: [
                    "La opresión familiar",
                    "La animalización de Gregorio",
                    "Lo humano, el arte, la belleza",
                    "La muerte como solución"
                ],
                correctIndex: 2
            },
            {
                question: "¿Cómo reacciona la familia ante la muerte de Gregorio?",
                options: [
                    "Con profundo dolor y luto",
                    "Con indiferencia y alivio",
                    "Con ira y resentimiento",
                    "Con miedo y remordimiento"
                ],
                correctIndex: 1
            },
            {
                question: "¿Qué tipo de sociedad se presenta en la obra?",
                options: [
                    "Comunista e igualitaria",
                    "Feudal y jerarquizada",
                    "Capitalista y deshumanizante",
                    "Socialista y solidaria"
                ],
                correctIndex: 2
            },
            {
                question: "¿Qué representa la manzana en la obra?",
                options: [
                    "El amor familiar",
                    "La redención",
                    "El odio y violencia familiar",
                    "La esperanza"
                ],
                correctIndex: 2
            }
        ];

        // Elementos del DOM
        const currentCardDisplay = document.getElementById('current-card');
        const totalCardsDisplay = document.getElementById('total-cards');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const flashcard = document.getElementById('current-flashcard');
        const questionElement = document.querySelector('.question');
        const answerElement = document.querySelector('.answer');
        const progressBar = document.getElementById('progress-bar');
        const tabButtons = document.querySelectorAll('.tab-btn');
        const flashcardSection = document.getElementById('flashcard-section');
        const questionSection = document.getElementById('question-section');
        const questionStatement = document.getElementById('question-statement');
        const optionsContainer = document.getElementById('options-container');
        const feedbackElement = document.getElementById('feedback');
        const currentQuestionDisplay = document.getElementById('current-question');
        const totalQuestionsDisplay = document.getElementById('total-questions');
        const quizPrevBtn = document.getElementById('quiz-prev-btn');
        const quizNextBtn = document.getElementById('quiz-next-btn');
        const repetitionInfo = document.getElementById('repetition-info');
        
        // Estado de la aplicación
        let currentCardIndex = 0;
        let currentDeck = [...formasDeTratamiento];
        let currentTab = 'formas';
        let shuffledDeck = [...formasDeTratamiento];
        let isFlipping = false;
        let currentQuestionIndex = 0;
        let selectedOption = -1;
        let showAnswer = false;
        
        // Almacén para repetición espaciada
        let incorrectQuestions = []; // Índices de preguntas falladas
        let spacedRepetitionDeck = []; // Deck especial con preguntas repetidas
        
        // Inicialización
        function init() {
            totalCardsDisplay.textContent = formasDeTratamiento.length;
            totalQuestionsDisplay.textContent = kahootQuestions.length;
            updateCardDisplay();
            
            // Event listeners
            flashcard.addEventListener('click', flipCard);
            prevBtn.addEventListener('click', showPrevCard);
            nextBtn.addEventListener('click', showNextCard);
            shuffleBtn.addEventListener('click', shuffleCards);
            tabButtons.forEach(btn => btn.addEventListener('click', switchTab));
            quizPrevBtn.addEventListener('click', showPrevQuestion);
            quizNextBtn.addEventListener('click', showNextQuestion);
            
            // Eventos táctiles para voltear
            flashcard.addEventListener('touchstart', handleTouchStart, { passive: true });
            flashcard.addEventListener('touchend', handleTouchEnd, { passive: true });
            
            // Eventos para deslizar
            document.addEventListener('touchstart', handleSwipeStart, { passive: true });
            document.addEventListener('touchend', handleSwipeEnd, { passive: true });
            
            // Eventos de teclado
            document.addEventListener('keydown', handleKeyDown);
            
            // Inicializar deck de repetición espaciada
            spacedRepetitionDeck = [...kahootQuestions];
            
            // Actualizar sección de preguntas
            updateQuestionDisplay();
        }
        
        // Cambiar pestaña
        function switchTab(e) {
            const tab = e.target.dataset.tab;
            
            // Actualizar botones de pestaña
            tabButtons.forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            currentTab = tab;
            
            // Mostrar la sección correspondiente
            if (tab === 'preguntas') {
                flashcardSection.style.display = 'none';
                document.querySelector('.swipe-instruction').style.display = 'none';
                document.querySelector('.controls-bottom').style.display = 'none';
                questionSection.classList.add('active');
                updateQuestionDisplay();
            } else {
                flashcardSection.style.display = 'flex';
                document.querySelector('.swipe-instruction').style.display = 'flex';
                document.querySelector('.controls-bottom').style.display = 'flex';
                questionSection.classList.remove('active');
                
                // Cambiar el conjunto de fichas
                if (tab === 'formas') {
                    currentDeck = [...formasDeTratamiento];
                } else if (tab === 'metamorfosis') {
                    currentDeck = [...metamorfosisCards];
                }
                
                totalCardsDisplay.textContent = currentDeck.length;
                shuffledDeck = [...currentDeck];
                currentCardIndex = 0;
                updateCardDisplay();
            }
        }
        
        // Actualizar la visualización de la tarjeta actual
        function updateCardDisplay() {
            const card = shuffledDeck[currentCardIndex];
            questionElement.textContent = card.question;
            answerElement.innerHTML = card.answer;
            
            currentCardDisplay.textContent = currentCardIndex + 1;
            
            // Actualizar barra de progreso
            const progress = ((currentCardIndex + 1) / shuffledDeck.length) * 100;
            progressBar.style.width = `${progress}%`;
            
            // Reiniciar estado de volteo
            flashcard.classList.remove('flipped');
        }
        
        // Voltear la tarjeta
        function flipCard() {
            if (isFlipping) return;
            
            isFlipping = true;
            flashcard.classList.toggle('flipped');
            
            // Permitir otro volteo después de la animación
            setTimeout(() => {
                isFlipping = false;
            }, 600);
        }
        
        // Manejar toques para voltear en iOS
        let touchStartTime = 0;
        
        function handleTouchStart(e) {
            touchStartTime = Date.now();
        }
        
        function handleTouchEnd(e) {
            const touchDuration = Date.now() - touchStartTime;
            if (touchDuration < 500) { // Solo considerar toques cortos
                flipCard();
            }
        }
        
        // Mostrar tarjeta anterior
        function showPrevCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateCardDisplay();
            }
        }
        
        // Mostrar siguiente tarjeta
        function showNextCard() {
            if (currentCardIndex < shuffledDeck.length - 1) {
                currentCardIndex++;
                updateCardDisplay();
            }
        }
        
        // Mezclar tarjetas
        function shuffleCards() {
            shuffledDeck = [...currentDeck];
            for (let i = shuffledDeck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledDeck[i], shuffledDeck[j]] = [shuffledDeck[j], shuffledDeck[i]];
            }
            currentCardIndex = 0;
            updateCardDisplay();
        }
        
        // Manejar deslizamiento
        let swipeStartX = 0;
        
        function handleSwipeStart(e) {
            swipeStartX = e.touches[0].clientX;
        }
        
        function handleSwipeEnd(e) {
            if (!swipeStartX) return;
            
            const swipeEndX = e.changedTouches[0].clientX;
            const diff = swipeEndX - swipeStartX;
            const threshold = 50; // Mínimo de píxeles para considerar un deslizamiento
            
            if (diff > threshold) {
                showPrevCard();
            } else if (diff < -threshold) {
                showNextCard();
            }
            
            swipeStartX = 0;
        }
        
        // Manejar teclado
        function handleKeyDown(e) {
            switch(e.key) {
                case 'ArrowLeft':
                    if (currentTab === 'preguntas') showPrevQuestion();
                    else showPrevCard();
                    break;
                case 'ArrowRight':
                    if (currentTab === 'preguntas') showNextQuestion();
                    else showNextCard();
                    break;
                case ' ':
                case 'Spacebar':
                    if (currentTab !== 'preguntas') flipCard();
                    e.preventDefault();
                    break;
            }
        }
        
        // Actualizar la visualización de la pregunta
        function updateQuestionDisplay() {
            // Determinar si estamos mostrando una pregunta fallada
            const isFailedQuestion = incorrectQuestions.includes(currentQuestionIndex);
            repetitionInfo.style.display = isFailedQuestion ? 'block' : 'none';
            
            const question = kahootQuestions[currentQuestionIndex];
            questionStatement.textContent = question.question;
            
            // Limpiar opciones anteriores
            optionsContainer.innerHTML = '';
            feedbackElement.textContent = '';
            feedbackElement.className = 'feedback';
            selectedOption = -1;
            showAnswer = false;
            
            // Crear botones de opciones
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.textContent = option;
                button.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(button);
            });
            
            currentQuestionDisplay.textContent = currentQuestionIndex + 1;
        }
        
        // Seleccionar una opción
        function selectOption(index) {
            if (showAnswer) return;
            
            const buttons = document.querySelectorAll('.option-btn');
            
            // Remover selección anterior
            buttons.forEach(btn => btn.classList.remove('selected'));
            
            // Seleccionar nueva opción
            buttons[index].classList.add('selected');
            selectedOption = index;
            
            // Mostrar feedback
            showAnswer = true;
            const isCorrect = (index === kahootQuestions[currentQuestionIndex].correctIndex);
            
            // Manejar repetición espaciada
            if (!isCorrect && !incorrectQuestions.includes(currentQuestionIndex)) {
                // Añadir a preguntas falladas
                incorrectQuestions.push(currentQuestionIndex);
            } else if (isCorrect && incorrectQuestions.includes(currentQuestionIndex)) {
                // Eliminar de preguntas falladas si se responde correctamente
                incorrectQuestions = incorrectQuestions.filter(i => i !== currentQuestionIndex);
            }
            
            // Actualizar UI según respuesta
            if (isCorrect) {
                buttons[index].classList.add('correct');
                feedbackElement.textContent = '¡Correcto!';
                feedbackElement.classList.add('correct');
            } else {
                buttons[index].classList.add('incorrect');
                // Marcar la respuesta correcta
                buttons[kahootQuestions[currentQuestionIndex].correctIndex].classList.add('correct');
                feedbackElement.textContent = 'Incorrecto. Intenta de nuevo.';
                feedbackElement.classList.add('incorrect');
            }
        }
        
        // Mostrar pregunta anterior
        function showPrevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                updateQuestionDisplay();
            }
        }
        
        // Mostrar siguiente pregunta con repetición espaciada
        function showNextQuestion() {
            // Determinar si debemos priorizar preguntas falladas
            if (incorrectQuestions.length > 0 && Math.random() > 0.3) {
                // Seleccionar aleatoriamente una pregunta fallada
                const randomIndex = Math.floor(Math.random() * incorrectQuestions.length);
                currentQuestionIndex = incorrectQuestions[randomIndex];
            } else {
                // Continuar con el orden normal
                if (currentQuestionIndex < kahootQuestions.length - 1) {
                    currentQuestionIndex++;
                } else {
                    // Volver al principio si estamos al final
                    currentQuestionIndex = 0;
                }
            }
            
            updateQuestionDisplay();
        }
        
        // Iniciar la aplicación
        window.onload = init;
    </script>
</body>
</html>
